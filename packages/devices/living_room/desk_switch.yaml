mqtt:
  sensor:
    - name: "Desk switch battery"
      state_topic: "z2m_deconz/desk_switch"
      availability_topic: "z2m_deconz/bridge/state"
      unit_of_measurement: "%"
      device_class: "battery"
      value_template: "{{ value_json.battery }}"
    - name: "Desk switch LQI"
      state_topic: "z2m_deconz/desk_switch"
      availability_topic: "z2m_deconz/bridge/state"
      unit_of_measurement: "lqi"
      device_class: "signal_strength"
      value_template: "{{ value_json.linkquality }}"


automation:
  - alias: Living room · Desk switch
    use_blueprint:
      path: aqara_switch.yaml
      input:
        z2m_topic: "z2m_deconz/desk_switch/action"
        click:
          - service: light.toggle
            data_template:
              entity_id: light.living_room_main
              brightness_pct: "{{ is_state('sensor.house_mode', 'night') | iif(40, 100) }}"

        double_click:
          - service: light.toggle
            data_template:
              entity_id: light.living_room_ambient
              brightness_pct: "{{ is_state('sensor.house_mode', 'night') | iif(40, 100) }}"

        hold:
          - service: media_player.media_play_pause
            entity_id: media_player.living_room
