# https://www.home-assistant.io/integrations/spotify
spotify:
  client_id: !secret spotify_client_id
  client_secret: !secret spotify_client_secret

script:
  music_play:
    alias: Music 路 Play
    sequence:
      - service: script.music_join_sonoses
      - service: media_player.volume_set
        entity_id: group.all_sonos
        data_template:
          volume_level: "{{ volume_level | default(0.3) }}"
      - service: media_player.shuffle_set
        data_template:
          entity_id: media_player.master_bedroom
          shuffle: "{{ shuffle | default(true) }}"
      - service: media_player.select_source
        data_template:
          entity_id: media_player.master_bedroom
          source: "{{ playlist | default('Evening Chill') }}"

automation:
  - alias: Music 路 Play/Pause on Magic Cube Knock
    trigger:
      platform: event
      event_type: zha_event
      event_data:
        device_ieee: !secret magic_cube_ieee
        command: knock
    action:
      - service: media_player.media_play_pause
        data:
          entity_id: media_player.living_room

  - alias: Music 路 Volume down on Magic Cube rotate left
    trigger:
      platform: event
      event_type: zha_event
      event_data:
        device_ieee: !secret magic_cube_ieee
        command: rotate_left
    action:
      - service: media_player.volume_down
        data:
          entity_id: media_player.living_room

  - alias: Music 路 Volume up on Magic Cube rotate right
    trigger:
      platform: event
      event_type: zha_event
      event_data:
        device_ieee: !secret magic_cube_ieee
        command: rotate_right
    action:
      - service: media_player.volume_up
        data:
          entity_id: media_player.living_room
